name: "ê³¼ì œ ì œì¶œ ì´ìŠˆ ìë™í™”"

on:
  workflow_dispatch:
    inputs:
      session_info:
        description: 'ì„¸ì…˜ ì œëª© (ì˜ˆ: ì‹¬í™”ì„¸ì…˜ 0ì°¨ì‹œ)'
        required: true
        default: 'ì„¸ì…˜ 0ì°¨ì‹œ ê³¼ì œ'
      assignment_name:
        description: 'ê³¼ì œ íŒŒì¼ëª… (ì˜ˆ: assignment_ensemble.ipynb)'
        required: true
        default: 'assignment_{ì£¼ì œ}.ipynb'
      requirements:
        description: 'ê³¼ì œ ìš”êµ¬ ì‚¬í•­ ì²´í¬ë¦¬ìŠ¤íŠ¸ (ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„)'
        required: true
        default: 'ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”'

permissions:
  issues: write
  contents: read

jobs:
  create_issues:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: "ì´ìŠˆ ìƒì„±"
        env:
          GH_TOKEN: ${{ github.token }}
          REQUIREMENTS: ${{ github.event.inputs.requirements }}
          ASSIGNMENT_NAME: ${{ github.event.inputs.assignment_name }}
          SESSION_INFO: ${{ github.event.inputs.session_info }}
        run: |
          FORMATTED_REQ=$(echo -e "$REQUIREMENTS" | sed 's/^/- [ ] /')

          members=("í™ê¸¸ë™" "ê¹€ì² ìˆ˜" "ì´ì˜í¬" "ë°•ë¯¼ìˆ˜")

          for member in "${members[@]}"
          do
            issue_body=$(cat <<EOF
          ### ğŸ” ê³¼ì œ
          - [ ] $ASSIGNMENT_NAME íŒŒì¼ ê³¼ì œ ìˆ˜í–‰

          ### ğŸ” ì‚¬ì „ê³¼ì œ ìš”êµ¬ì‚¬í•­
          $FORMATTED_REQ

          ### âœ… ê³¼ì œ ì œì¶œ í™•ì¸ ì‚¬í•­
          - [ ] ë³¸ì¸ì˜ ë¸Œëœì¹˜ì—ì„œ ì‘ì—…í•˜ê³  add, commit, push í–ˆë‚˜ìš”?
          - [ ] develop <- ë³¸ì¸ ë¸Œëœì¹˜ë¡œ pull request í•˜ê³  ìˆë‚˜ìš”?
          EOF
          )

            gh issue create \
              --title "[submit] $SESSION_INFO: ${member}" \
              --body "$issue_body" \
              --label "submit"
          done